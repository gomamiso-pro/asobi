<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Web制作支援ツール（V115 修正版）</title>

<!-- Google Fonts & Bootstrap -->
<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700;900&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="style.css" />

</head>
<body>

<div class="header-content">
  <h1>Web制作 設計支援ツール</h1>
  <button id="qrCodeButton" class="qr-button" title="ツールのQRコードを表示">🌐</button>
</div>

<!-- （中略：①〜④はそのまま保持） -->
<!-- あなたのヒアリングセクションやAI指示文部分は省略可能。ここでは⑤を修正版にして掲載。 -->

<section id="pagePreviewSection">
  <h2>⑤ デザインイメージ / AI生成WebページHTMLプレビュー</h2>
  <p class="hint">⬆︎デザイン設定の変更でリアルタイムにイメージが更新されます。</p>

  <div id="dynamicPreviewArea" class="card p-3 shadow-sm" style="min-height: 450px;">
    <iframe id="pagePreview" style="width:100%; height:420px; border:1px solid #ccc; border-radius:8px;"></iframe>
  </div>

  <textarea id="aiPageHtmlInput" rows="10" placeholder="AIが生成したHTMLコードをここに貼り付け"></textarea>
  <div class="pagecode-actions">
      <button id="previewAiPageBtn" onclick="previewAiPageHtml()">AIコードをプレビュー</button>
      <button onclick="clearPagePreview()">プレビューをクリア</button>
  </div>
</section>

<footer style="text-align:center; margin:18px 0 60px 0;">
  <small>ツール提供 — Web制作アシスタント（簡易版）</small>
</footer>

<!-- QRコード生成用モーダル -->
<div class="modal fade" id="qrModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content text-center p-3">
      <h5>ツールのQRコード</h5>
      <div id="qrContainer" class="my-3"></div>
      <p><a href="https://gomamiso-pro.github.io/asobi/" target="_blank">https://gomamiso-pro.github.io/asobi/</a></p>
      <button type="button" class="btn btn-secondary mt-2" data-bs-dismiss="modal">閉じる</button>
    </div>
  </div>
</div>

<!-- ライブラリ読み込み -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script src="script.js"></script>

<script>
/* =============================
   QRコードボタン処理
============================= */
document.addEventListener('DOMContentLoaded', function() {
  const qrButton = document.getElementById('qrCodeButton');
  const qrContainer = document.getElementById('qrContainer');
  const qrModal = new bootstrap.Modal(document.getElementById('qrModal'));

  qrButton.addEventListener('click', () => {
    qrContainer.innerHTML = ''; // 一度クリア
    new QRCode(qrContainer, {
      text: "https://gomamiso-pro.github.io/asobi/",
      width: 180,
      height: 180
    });
    qrModal.show();
  });
});

/* =============================
   ⑤ デザインプレビュー処理
============================= */
function updateDesignPreview() {
  const font = document.getElementById('mainFontSelect')?.value || "'M PLUS Rounded 1c', sans-serif";
  const color = document.getElementById('themeColorSelect')?.value || "#007bff";
  const layout = document.getElementById('layoutPatternSelect')?.value || "full-hero";
  const shape = document.getElementById('buttonShapeSelect')?.value || "medium-round";

  const css = `
    body { font-family: ${font}; background: #fff; color:#333; margin:0; padding:20px; }
    .header { background:${color}; color:white; text-align:center; padding:15px; border-radius:12px; }
    .button { background:${color}; color:white; border:none; border-radius:${shape==='pill'?'50px':shape==='square'?'4px':'10px'}; padding:10px 20px; cursor:pointer; }
  `;
  const html = `
    <!DOCTYPE html><html><head><style>${css}</style></head><body>
    <div class="header"><h1>プレビュー：${layout}</h1></div>
    <div style="text-align:center; margin-top:40px;">
      <p>テーマカラー: ${color}</p>
      <p>フォント: ${font}</p>
      <button class="button">サンプルボタン</button>
    </div>
    </body></html>
  `;
  document.getElementById('pagePreview').srcdoc = html;
}

function previewAiPageHtml() {
  const html = document.getElementById('aiPageHtmlInput').value;
  document.getElementById('pagePreview').srcdoc = html;
}

function clearPagePreview() {
  document.getElementById('aiPageHtmlInput').value = '';
  updateDesignPreview();
}

// ページロード時初期化
window.addEventListener('load', updateDesignPreview);
</script>
</body>
</html>
