<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>とも & かしこの顔選択かけっこ</title>
<style>
  body { font-family:sans-serif; text-align:center; background:#f0f0f0; margin:0; padding:0; overflow-x:hidden; }
  header { background:#8ecae6; color:white; padding:20px; }
  #face-selection { display:flex; flex-wrap:wrap; justify-content:center; gap:5px; margin:20px 0; max-height:200px; overflow-y:auto; }
  .face { width:50px; height:50px; cursor:pointer; border:2px solid transparent; }
  .face.selected { border-color:#ff0000; }
  .race { position:relative; width:100%; height:100px; background:#e0f7fa; overflow:hidden; margin:20px 0; }
  .runner { position:absolute; bottom:10px; width:50px; height:50px; }
  svg { width:100%; height:100%; }
  button { padding:10px 20px; font-size:1em; cursor:pointer; }
</style>
</head>
<body>

<header><h1>とも & かしこの顔選択かけっこ</h1></header>

<!-- 顔選択 -->
<div id="face-selection"></div>
<button id="go-btn">GO!</button>

<!-- レース -->
<div class="race">
  <div class="runner" id="tomo-runner"></div>
  <div class="runner" id="kashiko-runner"></div>
</div>

<script>
// 顔データ10個（カテゴリ分け例: 笑顔系5個, さみしげ系5個）
const faces = [
  // 笑顔系
  `<circle cx="25" cy="25" r="25" fill="#ffb703"/><circle cx="17" cy="17" r="4"/><circle cx="33" cy="17" r="4"/><path d="M17,33 Q25,40 33,33" stroke="#000" fill="transparent"/>`,
  `<circle cx="25" cy="25" r="25" fill="#ffb703"/><circle cx="17" cy="17" r="4"/><circle cx="33" cy="17" r="4"/><path d="M17,33 Q25,42 33,33" stroke="#000" fill="transparent"/>`,
  `<circle cx="25" cy="25" r="25" fill="#ffb703"/><circle cx="17" cy="17" r="4"/><circle cx="33" cy="17" r="4"/><path d="M17,33 Q25,38 33,33" stroke="#000" fill="transparent"/>`,
  `<circle cx="25" cy="25" r="25" fill="#ffb703"/><circle cx="17" cy="17" r="4"/><circle cx="33" cy="17" r="4"/><path d="M17,33 Q25,36 33,33" stroke="#000" fill="transparent"/>`,
  `<circle cx="25" cy="25" r="25" fill="#ffb703"/><circle cx="17" cy="17" r="4"/><circle cx="33" cy="17" r="4"/><path d="M17,33 Q25,44 33,33" stroke="#000" fill="transparent"/>`,
  // さみしげ系
  `<circle cx="25" cy="25" r="25" fill="#219ebc"/><circle cx="17" cy="17" r="4"/><circle cx="33" cy="17" r="4"/><path d="M17,33 Q25,30 33,33" stroke="#000" fill="transparent"/>`,
  `<circle cx="25" cy="25" r="25" fill="#219ebc"/><circle cx="17" cy="17" r="4"/><circle cx="33" cy="17" r="4"/><path d="M17,33 Q25,28 33,33" stroke="#000" fill="transparent"/>`,
  `<circle cx="25" cy="25" r="25" fill="#219ebc"/><circle cx="17" cy="17" r="4"/><circle cx="33" cy="17" r="4"/><path d="M17,33 Q25,32 33,33" stroke="#000" fill="transparent"/>`,
  `<circle cx="25" cy="25" r="25" fill="#219ebc"/><circle cx="17" cy="17" r="4"/><circle cx="33" cy="17" r="4"/><path d="M17,33 Q25,25 33,33" stroke="#000" fill="transparent"/>`,
  `<circle cx="25" cy="25" r="25" fill="#219ebc"/><circle cx="17" cy="17" r="4"/><circle cx="33" cy="17" r="4"/><path d="M17,33 Q25,27 33,33" stroke="#000" fill="transparent"/>`
];

// 顔選択画面表示
const selectionDiv = document.getElementById('face-selection');
faces.forEach((f,i)=>{
  const svg = document.createElementNS("http://www.w3.org/2000/svg","svg");
  svg.classList.add("face");
  svg.dataset.face = i;
  svg.innerHTML = f;
  svg.addEventListener('click', ()=>{
    document.querySelectorAll('.face').forEach(e=>e.classList.remove('selected'));
    svg.classList.add('selected');
    selectedFace = i;
  });
  selectionDiv.appendChild(svg);
});

let selectedFace = 0;

// ランナー初期設定
const tomoRunner = document.getElementById('tomo-runner');
const kashikoRunner = document.getElementById('kashiko-runner');
tomoRunner.innerHTML = faces[0];
kashikoRunner.innerHTML = faces[5];

// 追いかけっこアニメ
let posTomo = 0;
let posKashiko = 5;
let running = false;

function race(){
  if(!running) return;
  posTomo += 0.7 + Math.random()*0.5;
  posKashiko += 0.65 + Math.random()*0.6;

  if(posTomo>100) posTomo=0;
  if(posKashiko>100) posKashiko=5;

  tomoRunner.style.left = posTomo+'%';
  kashikoRunner.style.left = posKashiko+'%';

  // 顔切替
  if(Math.abs(posTomo-posKashiko)<5){
    tomoRunner.innerHTML = faces[selectedFace];
    kashikoRunner.innerHTML = faces[(selectedFace+5)%10];
  }else{
    tomoRunner.innerHTML = faces[(selectedFace+1)%5];
    kashikoRunner.innerHTML = faces[(selectedFace+6)%10];
  }

  requestAnimationFrame(race);
}

// GOボタン
document.getElementById('go-btn').addEventListener('click',()=>{ running = true; });

</script>
</body>
</html>
