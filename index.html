<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Web制作支援ツール（１）</title>
<link rel="stylesheet" href="style.css" />
<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700;900&display=swap" rel="stylesheet">
</head>
<body>

<h1>Web制作 設計支援ツール</h1>

<!-- ① ヒアリング -->
<section id="hearingSection">
  <h2>① ヒアリングシート入力</h2>

  <label>プロジェクト概要（任意）</label>
  <textarea id="projectOverviewInput" placeholder="未入力の場合はおまかせ"></textarea>

  <label>Webページ分類</label>
  <select id="pageTypeSelect">
    <option value="コーポレート／ブランド">コーポレート／ブランド</option>
    <option value="EC・販売サイト">EC・販売サイト</option>
    <option value="メディア・ブログ">メディア・ブログ</option>
    <option value="業務システム">業務システム</option>
    <option value="LP・キャンペーン">LP・キャンペーン</option>
    <option value="ポータル・コミュニティ">ポータル・コミュニティ</option>
    <option value="おまかせ">おまかせ</option>
  </select>

  <label>ユーザー層・想定デバイス</label>
  <select id="userTargetSelect">
    <option value="一般ユーザー（20〜40代）">一般ユーザー（20〜40代）</option>
    <option value="BtoB企業">BtoB企業</option>
    <option value="管理者／社内利用">管理者／社内利用</option>
    <option value="学生／若年層">学生／若年層</option>
    <option value="高齢層中心">高齢層中心</option>
    <option value="おまかせ">おまかせ</option>
  </select>

  <label>デザイン方針</label>
  <select id="designSelect">
    <option value="シンプル＆ミニマル">シンプル＆ミニマル</option>
    <option value="ビジネス＆信頼重視">ビジネス＆信頼重視</option>
    <option value="ポップ＆カジュアル">ポップ＆カジュアル</option>
    <option value="高級・スタイリッシュ">高級・スタイリッシュ</option>
    <option value="自然・ナチュラル">自然・ナチュラル</option>
    <option value="おまかせ">おまかせ</option>
  </select>

  <label>データ・連携・管理要件</label>
  <textarea id="dataRequirementInput" placeholder="未入力の場合はおまかせ"></textarea>

  <label>運用・更新・公開</label>
  <textarea id="operationInput" placeholder="未入力の場合はおまかせ"></textarea>

  <label>使用言語（複数選択可）</label>
  <div class="checkbox-row">
    <label><input type="checkbox" id="lang_html" value="HTML">HTML</label>
    <label><input type="checkbox" id="lang_css" value="CSS">CSS</label>
    <label><input type="checkbox" id="lang_js" value="JavaScript">JavaScript</label>
    <label><input type="checkbox" id="lang_python" value="Python">Python</label>
    <label><input type="checkbox" id="lang_php" value="PHP">PHP</label>
    <label><input type="checkbox" id="lang_ruby" value="Ruby">Ruby</label>
  </div>

  <label>サーバー</label>
  <select id="serverSelect">
    <option value="さくらレンタルサーバー">さくらレンタルサーバー</option>
    <option value="XServer">XServer</option>
    <option value="AWS">AWS</option>
    <option value="Firebase">Firebase</option>
    <option value="Vercel">Vercel</option>
    <option value="おまかせ">おまかせ</option>
  </select>

  <label>データベース</label>
  <select id="databaseSelect">
    <option value="MySQL">MySQL</option>
    <option value="PostgreSQL">PostgreSQL</option>
    <option value="SQLite">SQLite</option>
    <option value="Firebase">Firebase</option>
    <option value="おまかせ">おまかせ</option>
  </select>

  <label>デザインフレームワーク</label>
  <select id="designFrameworkSelect">
    <option value="Bootstrap">Bootstrap</option>
    <option value="Tailwind">Tailwind</option>
    <option value="Material UI">Material UI</option>
    <option value="おまかせ">おまかせ</option>
  </select>

  <label>認証方式</label>
  <select id="authSelect">
    <option value="メール認証">メール認証</option>
    <option value="OAuth">OAuth</option>
    <option value="SSO">SSO</option>
    <option value="おまかせ">おまかせ</option>
  </select>

  <label>公開・セキュリティ・拡張性</label>
  <textarea id="securityInput" placeholder="未入力の場合はおまかせ"></textarea>

  <hr>
  <h3>ページ設定</h3>
  <div class="page-controls">
    <button onclick="addPage()">＋ ページ追加</button>
    <button onclick="clearAllPages()">すべてのページをクリア</button>
  </div>
  <div id="pageContainer" class="page-container"></div>
</section>

<!-- ② 見積 -->
<section id="estimateSection">
  <h2>② 見積金額明細</h2>
  <table id="estimateTable">
    <thead><tr><th>項目</th><th>単価</th><th>数量</th><th>小計</th></tr></thead>
    <tbody></tbody>
    <tfoot>
      <tr><th colspan="3">合計（税抜）</th><th id="subtotal">0</th></tr>
      <tr><th colspan="3">合計（税込10%）</th><th id="total">0</th></tr>
    </tfoot>
  </table>
  <div class="estimate-actions">
    <button onclick="downloadEstimate()">見積書ダウンロード（.txt）</button>
  </div>
</section>

<!-- ③ AI指示 -->
<section id="instructionSection">
  <h2>③ 設計書作成用 AI 指示文（自動生成）</h2>
    <button onclick="generateInstructions()">AI指示文を生成</button>
  <br>
  <textarea id="aiInstructions" rows="8" readonly>ここにヒアリング情報を基にしたAI指示文が表示されます</textarea>
  <div class="instruction-actions">
    <button onclick="copyInstructions()">コピー</button>
    <button onclick="downloadInstructions()">ダウンロード（.txt）</button>
  </div>
</section>

<!-- ④ AI生成コード貼付け -->
<section id="designImportSection">
  <h2>④ AI生成コード（設計書）を貼付け → 描画</h2>
  <p class="hint">AI（ChatGPT等）で生成した設計書（Markdown / プレーンテキスト / JSON）をここに貼り付けて「設計書を描画」してください。</p>
  <textarea id="aiCodeInput" rows="10" placeholder="AIが生成した設計書をここに貼り付け"></textarea>
  <div class="design-import-actions">
    <button onclick="renderDesignDocs()">設計書を描画</button>
    <button onclick="clearRenderedDesigns()">描画をクリア</button>
  </div>
</section>

<!-- ⑤ 設計書描画 -->
<section id="designOutputSection">
  <h2>⑤ 設計書（描画）</h2>

  <div id="generateFunctionList" class="design-block"></div>
  <div id="generateTableDefinition" class="design-block"></div>
  <div id="generateTransitionDiagram" class="design-block"></div>

  <div class="design-actions">
    <button onclick="copyRendered('generateFunctionList')">機能一覧をコピー</button>
    <button onclick="downloadRendered('functionList')">機能一覧ダウンロード</button>

    <button onclick="copyRendered('generateTableDefinition')">テーブル定義をコピー</button>
    <button onclick="downloadRendered('tableDefinition')">テーブル定義ダウンロード</button>

    <button onclick="copyRendered('generateTransitionDiagram')">遷移図をコピー</button>
    <button onclick="downloadRendered('transitionDiagram')">遷移図ダウンロード</button>

    <button onclick="downloadAllDesigns()">すべての設計書をまとめてダウンロード</button>
  </div>
</section>

<!-- ⑥ ページコード生成とプレビュー -->
<section id="pagePreviewSection">
  <h2>⑥ 各ページのコード生成・プレビュー・ダウンロード</h2>
  <p class="hint">「ページコード生成」で、各ページごとの簡易HTML/CSS/JSを自動生成します（プレビューは最初のページ）。</p>
  <div class="pagecode-actions">
    <button onclick="generatePageCode()">ページコード生成</button>
    <button onclick="downloadPageCode()">生成コードを全ページダウンロード</button>
  </div>
  <iframe id="pagePreview"></iframe>
</section>

<footer style="text-align:center; margin:18px 0 60px 0;">
  <small>ツール提供 — Web制作アシスタント（簡易版）</small>
</footer>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
    // DOMContentLoaded後にMermaidを実行
    document.addEventListener('DOMContentLoaded', function() {
        mermaid.initialize({ startOnLoad: true });
    });
</script>
</body>
</html>
