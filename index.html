<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>とも & かしこの追いかけっこ</title>
<style>
  body { font-family:sans-serif; text-align:center; background:#f0f0f0; margin:0; padding:0; overflow-x:hidden;}
  header { background:#8ecae6; color:white; padding:20px; }
  #face-selection { display:flex; justify-content:center; gap:10px; margin:20px 0; }
  .face { width:60px; height:60px; cursor:pointer; border:2px solid transparent; }
  .face.selected { border-color:#ff0000; }
  .race { position:relative; width:100%; height:100px; background:#e0f7fa; overflow:hidden; margin:20px 0; }
  .runner { position:absolute; bottom:10px; width:50px; height:50px; }
  svg { width:100%; height:100%; }
</style>
</head>
<body>

<header><h1>とも & かしこの追いかけっこ</h1></header>

<div id="face-selection">
  <svg class="face" data-face="1"></svg>
  <svg class="face" data-face="2"></svg>
  <svg class="face" data-face="3"></svg>
  <svg class="face" data-face="4"></svg>
</div>

<button id="go-btn">GO!</button>

<div class="race">
  <div class="runner" id="tomo-runner"></div>
  <div class="runner" id="kashiko-runner"></div>
</div>

<script>
// 顔SVGデータ
const faces = [
`<circle cx="25" cy="25" r="25" fill="#ffb703"/><circle cx="17" cy="17" r="4" fill="#000"/><circle cx="33" cy="17" r="4" fill="#000"/><path d="M17,33 Q25,40 33,33" stroke="#000" stroke-width="2" fill="transparent"/>`,
`<circle cx="25" cy="25" r="25" fill="#ffb703"/><circle cx="17" cy="17" r="4" fill="#000"/><circle cx="33" cy="17" r="4" fill="#000"/><path d="M17,33 Q25,30 33,33" stroke="#000" stroke-width="2" fill="transparent"/>`,
`<circle cx="25" cy="25" r="25" fill="#219ebc"/><circle cx="17" cy="17" r="4" fill="#000"/><circle cx="33" cy="17" r="4" fill="#000"/><path d="M17,33 Q25,38 33,33" stroke="#000" stroke-width="2" fill="transparent"/>`,
`<circle cx="25" cy="25" r="25" fill="#219ebc"/><circle cx="17" cy="17" r="4" fill="#000"/><circle cx="33" cy="17" r="4" fill="#000"/><path d="M17,33 Q25,28 33,33" stroke="#000" stroke-width="2" fill="transparent"/>`
];

const faceElements = document.querySelectorAll('.face');
let selectedFace = 0;

// 顔選択
faceElements.forEach((el, i)=>{
  el.innerHTML = faces[i];
  el.addEventListener('click', ()=>{
    faceElements.forEach(f=>f.classList.remove('selected'));
    el.classList.add('selected');
    selectedFace = i;
  });
});

// ランナー設定
const tomoRunner = document.getElementById('tomo-runner');
const kashikoRunner = document.getElementById('kashiko-runner');

// 初期顔
tomoRunner.innerHTML = faces[0];
kashikoRunner.innerHTML = faces[2];

// 追いかけっこアニメ
let posTomo = 0;
let posKashiko = 5;
let running = false;

function race() {
  if(!running) return;
  posTomo += 0.7 + Math.random()*0.5; 
  posKashiko += 0.65 + Math.random()*0.6;
  if(posTomo > 100) posTomo = 0;
  if(posKashiko > 100) posKashiko = 5;

  tomoRunner.style.left = posTomo + '%';
  kashikoRunner.style.left = posKashiko + '%';

  // 顔切替（追いつき感）
  if(Math.abs(posTomo - posKashiko) < 5){
    tomoRunner.innerHTML = faces[selectedFace]; // 選んだ顔
    kashikoRunner.innerHTML = faces[selectedFace+2]; // 相手の顔
  } else {
    // 追いつかない顔は2番・4番に
    tomoRunner.innerHTML = faces[(selectedFace+1)%4];
    kashikoRunner.innerHTML = faces[(selectedFace+3)%4];
  }

  requestAnimationFrame(race);
}

// GOボタン
document.getElementById('go-btn').addEventListener('click', ()=>{
  running = true;
});
</script>

</body>
</html>
